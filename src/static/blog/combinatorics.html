<!DOCTYPE html>
<html lang="en">
<head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app100.us.archive.org';v.server_ms=443;archive_analytics.send_pageview({});});</script><script type="text/javascript" src="/_static/js/playback.bundle.js?v=BsQ6byDz" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=cRqOKCOw" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("http://curtisautery.appspot.com/5799234494267392","20170702092920","https://web.archive.org/","web","/_static/",
	      "1498987760");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=NHuXCfBH" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->

	<meta charset="utf-8">
	
		
		<title>Combinatorics, brute force, and a surprising coding challenge</title>
		<meta name="description" content="A deep dive into a seemingly simple freeCodeCamp algorithm challenge">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="Curtis Autery">

	<link href="/web/20170702092920cs_/http://curtisautery.appspot.com/static/bootstrap/css/bootstrap.min.css" rel="stylesheet">

	<style type="text/css">
		#cover {
			background-size: 100% auto;
			background-image: url(/web/20170702092920im_/http://curtisautery.appspot.com/static/cover.jpg);
			border-radius: 6px;
			margin-top: -20px;
		}

		#cover h1 {
			color: #fff;
			background: rgba(0, 0, 0, 0.4);
			line-height: 1.5;
			font-size: 2em;
		}

		@media screen and (min-width: 768px) {
			#cover h1 {
			    font-size: 63px;
			}

			#body {
				text-align: justify;
			}
		}

		hr {
			border-top: 1px solid gray;
		}

		img {
			margin-bottom: 5px;
		}
	</style>

	<script type="text/javascript">
		function populate_entries( entries ) {
			$( '#entries' ).empty();
			for ( var e in entries ) add_entry( entries[e].Title, entries[e].ID );
		}

		function add_entry( title, key ) {
			var html = '<li><a href="/' + key + '">' + title + '</a></li>';
			$( '#entries' ).append( html );
		}

		function init() {
			if (document.location.pathname == "/1") $('#About').addClass("active");
			if (document.location.pathname == "/") {
				$('#Home').addClass("active");
				$('#latest').empty();
			} else {
				$.ajax({
					url: '/list',
					type: 'GET',
					success: function( results ) {
						populate_entries( $.parseJSON( results ) );
					},
					error: function( xhr, ajaxOptions, thrownError ) {
						console.log( xhr );
						console.log( ajaxOptions );
						alert( thrownError );
					}
				});
			}
		}
	</script>
</head>
<body onload="init()"><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="wm-ipp-inside">
  <div style="position:relative;">
    <div id="wm-logo" style="float:left;width:110px;padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="r" style="float:right;">
      <div id="wm-btns" style="text-align:right;height:25px;">
                  <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#"
	     title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php"
             title="Sign In"
             id="wm-sign-in"
          >
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        	<a href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" onclick="__wm.h(event);return false;" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share">
          <a href="/web/20170702092920/http://web.archive.org/screenshot/http://curtisautery.appspot.com/5799234494267392"
             id="wm-screenshot"
             title="screenshot">
            <span class="wm-icon-screen-shot"></span>
          </a>
	<a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20170702092920/http://curtisautery.appspot.com/5799234494267392" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20170702092920/http://curtisautery.appspot.com/5799234494267392" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
    </div>
    <table class="c" style="">
      <tbody>
	<tr>
	  <td class="u" colspan="2">
	    <form target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://curtisautery.appspot.com/5799234494267392" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20170702092920" /><input type="submit" value="Go" /></form>
	  </td>
	  <td class="n" rowspan="2" style="width:110px;">
	    <table>
	      <tbody>
		<!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
		<tr class="m">
		  <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20161018064444/http://curtisautery.appspot.com/5799234494267392" title="18 Oct 2016"><strong>Oct</strong></a></td>
		  <td class="c" id="displayMonthEl" title="You are here: 09:29:20 Jul 02, 2017">JUL</td>
		  <td class="f" nowrap="nowrap">Aug</td>
		</tr>
		<!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
		<tr class="d">
		  <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20161018064444/http://curtisautery.appspot.com/5799234494267392" title="06:44:44 Oct 18, 2016"><img src="/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
		  <td class="c" id="displayDayEl" style="width:34px;font-size:24px;white-space:nowrap;" title="You are here: 09:29:20 Jul 02, 2017">02</td>
		  <td class="f" nowrap="nowrap"><img src="/_static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0" /></td>
		</tr>
		<!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
		<tr class="y">
		  <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20160604072225/http://curtisautery.appspot.com:80/5799234494267392" title="04 Jun 2016"><strong>2016</strong></a></td>
		  <td class="c" id="displayYearEl" title="You are here: 09:29:20 Jul 02, 2017">2017</td>
		  <td class="f" nowrap="nowrap">2018</td>
		</tr>
	      </tbody>
	    </table>
	  </td>
	</tr>
	<tr>
	  <td class="s">
	    	    <div id="wm-nav-captures">
	      	      <a class="t" href="/web/20170702092920*/http://curtisautery.appspot.com/5799234494267392" title="See a list of every capture for this URL">10 captures</a>
	      <div class="r" title="Timespan for captures of this URL">12 Jan 2016 - 02 Jul 2017</div>
	      </div>
	  </td>
	  <td class="k">
	    <a href="" id="wm-graph-anchor">
	      <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
		<canvas id="wm-sparkline-canvas" width="625" height="27" border="0"></canvas>
	      </div>
	    </a>
	  </td>
	</tr>
      </tbody>
    </table>
    <div style="position:absolute;bottom:0;right:2px;text-align:right;">
      <a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span style="font-size:80%">About this capture</span></a>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
                    <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/webwidecrawl);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/webwidecrawl" target="_new"><span class="wm-title">Internet Archive</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  The Internet Archive discovers and captures web pages through many different web crawls.

At any given time several distinct crawls are running, some for months, and some every day or longer.

View the web archive through the <a href="http://archive.org/web/web.php">Wayback Machine</a>.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/survey_00005)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/survey_00005" target="_new"><span class="wm-title">Survey Crawl Number 5: Oct 21st, 2016 to Sep 10th, 2017</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  <p>The seed for this crawl was a list of every host in the Wayback Machine</p>

<p>This crawl was run at a level 1 (URLs including their embeds, plus the URLs of all outbound links including their embeds)</p>

<p>The WARC files associated with this crawl are not currently available to the general public.</p>
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;transpiled=0&amp;referer=https%3A//web.archive.org/web/20170702092920/http%3A//curtisautery.appspot.com/5799234494267392"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><script type="text/javascript">
__wm.bt(625,27,25,2,"web","http://curtisautery.appspot.com/5799234494267392","20170702092920",1996,"/_static/",["/_static/css/banner-styles.css?v=NHuXCfBH","/_static/css/iconochive.css?v=qtvMKcIJ"]);
  __wm.rw(1);
</script>
<!-- END WAYBACK TOOLBAR INSERT -->
	<div class="navbar navbar-inverse navbar-static-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
			</div>

			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li id="Home"><a href="/web/20170702092920/http://curtisautery.appspot.com/">Home</a></li>
					<li id="latest" class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">
							Latest
							<b class="caret"></b>
						</a>
						<ul id="entries" class="dropdown-menu">
							<li class="muted"><a href="javascript:blur()">loading...</a></li>
						</ul>
					</li>
				</ul>
				<ul class="nav navbar-nav navbar-right">
					<li id="About"><a href="/web/20170702092920/http://curtisautery.appspot.com/1">About</a></li>
					
				</ul>
			</div>
		</div>
	</div>

	<div class="container col-xs-12 col-md-8 col-md-offset-2">
		<div id="cover">
			<h1 class="text-center jumbotron">Stories for Outcasts</h1>
		</div>

		
			<h3 class="text-center">
				
					Combinatorics, brute force, and a surprising coding challenge
				
			</h3>
			<h4>Tuesday, December 29, 2015</h4>
			<div id="body">
				<p>Recently I've been checking out coding tutorial sites, including Hour of Code, Khan Exercises, Codecademy, freeCodeCamp (fCC). This last site interested me because of its promise to hook budding coders up with nonprofits, and also because their codebase is on GitHub, under active development, and references modern libraries and tools (D3/CodePen, for instance).</p>

<p>The fCC tutorial includes incremental instructions on how to write basic HTML and JavaScript, challenges to solve, and links to Wikipedia pages or other sources on topics that will be needed for the exercise. When presented with a problem, you type JavaScript code to solve it right into the page and submit it, where a number of test assertions are run against your code. For example, the <a href="https://web.archive.org/web/20170702092920/http://www.freecodecamp.com/challenges/bonfire-symmetric-difference">Symmetric Difference</a> algorithm problem looks like this:</p>

<p><img src="https://web.archive.org/web/20170702092920im_/https://c2.staticflickr.com/2/1526/23415855964%5F3bd10273be%5Fc.jpg" alt=""/></p>

<p>(The warning triangle is there because the library fCC uses for its syntax checks doesn't like arrow functions, but whatever your browser can execute runs fine against the test assertions.)</p>

<p>fCC appears to be successful at what it attempts. It has an active community, many users, and sparks local meetups in different cities, one of which I'm a member of. Whether or not it will be successful in the long run is anyone's guess, but it was at least successful in getting me out of my comfort zone of blogging on tech topics I'm interested in, and into coffee shops and libraries talking to other people.</p>

<h3>Algorithm challenge: permutations</h3>

<p>One of the advanced algorithm challenges on fCC is called <a href="https://web.archive.org/web/20170702092920/http://www.freecodecamp.com/challenges/bonfire-no-repeats-please">No repeats please</a>. It appears to be a simple combinatorics problem, but is a little more in-depth than it appears. Here is the text of the problem, and the test cases:</p>

<blockquote>
<p>Return the number of total permutations of the provided string that don't have repeated consecutive letters.</p>

<p>For example, 'aab' should return 2 because it has 6 total permutations, but only 2 of them don't have the same letter (in this case 'a') repeating.</p>

<p>permAlone("aab") should return a number.<br/>
permAlone("aab") should return 2.<br/>
permAlone("aaa") should return 0.<br/>
permAlone("aabb") should return 8.<br/>
permAlone("abcdefa") should return 3600.<br/>
permAlone("abfdefa") should return 2640.<br/>
permAlone("zzzzzzzz") should return 0.</p>


</blockquote>

<p>Like many academic exercises, this is pretty far from a real-world problem, but that doesn't detract from its value as a learning tool. Let's look at the 'aab' case first. Why does it have 6 permutations? There are only 3 distinct "words" from those letters, namely 'aab', 'aba', and 'baa'. Whence 6? Assumedly this is because each of the two a's should be considered unique for generating permutations, but not unique when counting repeated letters. If we distinguish that visually, we can see all 6 combinations. Let's take our first a and capitalize it:</p>



<pre><code>Aab
aAb
Aba
abA
bAa
baA
</code></pre>



<p>The permutations 'Aba' and 'abA' are the only two without 'A' and 'a' touching, so the algorithm we write should return 2 for that input.</p>

<h3>Rough draft solution</h3>

<p>Here is a recursive, brute force attack of this problem:</p>



<pre><code>var out;
function permAlone(prefix, arr) &#123;
    // Initialize if only called with one variable
    if (arr === undefined) &#123;
        arr = prefix.split(&#39;&#39;);
        prefix = &#91;&#93;;
        out = 0;
    &#125;
    if (arr.length == 1) &#123;
        var tst = prefix.concat(arr).join(&#39;&#39;); 
        if (!/(.)&#92;1/.test(tst)) out++;
    &#125;
    else &#123;
        arr.forEach((elem, ndx, a) =&gt; &#123;
            var tmp = a.slice();
            tmp.splice(ndx, 1);
            permAlone(prefix.concat(elem), tmp);
        &#125;);
    &#125;
    return out;
&#125;

permAlone(&#39;aab&#39;);
</code></pre>



<p>This splits the string passed to it into prefix and remainder arrays. The remainder array is iterated over, and each element is appended to the prefix array, and the function is called again. When the last digit of the remainder is reached, a string is built, and compared against a test regular expression to see if any duplicate letters are touching.</p>

<p>The regex I used is <code>/(.)\1/</code>, which is an idiomatic way to check for duplicate characters in a string. Everything in parentheses becomes a numbered match, starting with $1, then $2, $3, etc. A dot matches any character, and a number preceded by a backslash is a backreference, matching a prior numbered match. In regex-speak, this says "match any character immediately followed by itself." Predictably, others who solved this problem used the same regex I did.</p>

<p>Ideally, I'd like to have found a generic mathematical formula for calculating this, so I set about generating some other tests using my working brute-force solution, to try to untangle the underlying math.</p>

<h3>Searching for an algorithm</h3>

<p>First, I tested strings where there were no duplicated letters.</p>



<pre><code>permAlone(&#39;a&#39;)    =  1
permAlone(&#39;ab&#39;)   =  2
permAlone(&#39;abc&#39;)  =  6
permAlone(&#39;abcd&#39;) = 24
</code></pre>



<p>As expected, the results were the factorial of the string's length. Since there are no duplicated letters, each permutation, of which there are <code>n!</code>, passes the regex test. Next, strings with a single duplicated pair of letters:</p>



<pre><code>permAlone(&#39;aa&#39;)     =   0
permAlone(&#39;aab&#39;)    =   2
permAlone(&#39;aabc&#39;)   =  12
permAlone(&#39;aabcd&#39;)  =  72
permAlone(&#39;aabcde&#39;) = 480
</code></pre>



<p>This matches <code>n! - 2(n-1)!</code>. Next, strings with two pairs of duplicate letters:</p>



<pre><code>permAlone(&#39;aabb&#39;)    =    8
permAlone(&#39;aabbc&#39;)   =   48
permAlone(&#39;aabbcd&#39;)  =  336
permAlone(&#39;aabbcde&#39;) = 2640
</code></pre>



<p>After a bit of fiddling, I found a matching equation for these values, <code>n! - 4((n-1)! - (n-2)!)</code>, which gave me a lot of what turned out to be false hope for an easy generic solution. Here's the dealbreaker, three pairs of duplicate letters:</p>



<pre><code>permAlone(&#39;aabbcc&#39;)    =    240
permAlone(&#39;aabbccd&#39;)   =   1968
permAlone(&#39;aabbccde&#39;)  =  17760
permAlone(&#39;aabbccdef&#39;) = 175680
</code></pre>



<p>After playing with various forumlas until my eyes crossed, the best I came up with was a sequence to match the same numbers:</p>



<pre><code>6! - (3! &#42;  80) =    240
7! - (4! &#42; 128) =   1968
8! - (5! &#42; 188) =  17760
9! - (6! &#42; 260) = 175680
</code></pre>



<p>...but finding the significance of 80, 128, 188, and 260 eluded me, so I gave up trying to blindly churn through numbers, and turned to the <a href="https://web.archive.org/web/20170702092920/http://oeis.org/">OEIS</a>, the On-line Encyclopedia of Integer Sequences, which existed prior to the late-90's consumer Internet boom, hence 'on-line' is hyphenated unironically.</p>

<p>After some searching, I found 240 and 1968 in entry <a href="https://web.archive.org/web/20170702092920/http://oeis.org/A173841">A173841</a>, the number of permutations of 1 through N where no adjacent pair sums to N+1. A couple entries down, 17760 and 175680 were found in a similar sequence, <a href="https://web.archive.org/web/20170702092920/http://oeis.org/A173843">A173843</a>, where no pairs summed to N+3. The formulas were simple, and I was able to combine them to create a generic rule that applied to all of the test sequences I had generated so far:</p>



<pre><code>var fac = &#91;1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880, 3628800, 39916800, 479001600, 6227020800, 87178291200, 1307674368000, 20922789888000, 355687428096000, 6402373705728000&#93;;
function binomial(n, k) &#123;
    return fac&#91;n&#93; / (fac&#91;n - k&#93; &#42; fac&#91;k&#93;)
&#125;

function a(n, m) &#123;
    var sum = 0;
    for (var j = 0; j &lt;= m; j++) &#123;
        sum += Math.pow(-2, j) &#42; binomial(m, j) &#42; fac&#91;n - j&#93;;
    &#125;
    return sum;
&#125;
</code></pre>



<p>Rather than calculate factorials by rote, I used a fixed array up to the JavaScript maximum safe integer, to make calculating binomial coefficients a little easier. The inputs to the function are <code>n</code>, the length of the string, and <code>m</code>, the number of pairs of duplicated letters.</p>

<p>For strings from length 1 - 4 with no duplicates:</p>



<pre><code>a(1, 0) =  1 = permAlone(&#39;a&#39;)   
a(2, 0) =  2 = permAlone(&#39;ab&#39;)  
a(3, 0) =  6 = permAlone(&#39;abc&#39;) 
a(4, 0) = 24 = permAlone(&#39;abcd&#39;)
</code></pre>



<p>For strings from length 2 - 6 with one pair of duplicates:</p>



<pre><code>a(2, 1) =   0 = permAlone(&#39;aa&#39;)    
a(3, 1) =   2 = permAlone(&#39;aab&#39;)   
a(4, 1) =  12 = permAlone(&#39;aabc&#39;)  
a(5, 1) =  72 = permAlone(&#39;aabcd&#39;) 
a(6, 1) = 480 = permAlone(&#39;aabcde&#39;)
</code></pre>



<p>Length 4 - 7 with two pairs of duplicates:</p>



<pre><code>a(4, 2) =    8 = permAlone(&#39;aabb&#39;)   
a(5, 2) =   48 = permAlone(&#39;aabbc&#39;)  
a(6, 2) =  336 = permAlone(&#39;aabbcd&#39;) 
a(7, 2) = 2640 = permAlone(&#39;aabbcde&#39;)
</code></pre>



<p>And finally, the tricky one that sent me on this quest in the first place, length 6 - 9 with three duplicated pairs of letters:</p>



<pre><code>a(6, 3) =    240 = permAlone(&#39;aabbcc&#39;)   
a(7, 3) =   1968 = permAlone(&#39;aabbccd&#39;)  
a(8, 3) =  17760 = permAlone(&#39;aabbccde&#39;) 
a(9, 3) = 175680 = permAlone(&#39;aabbccdef&#39;)
</code></pre>



<p>This alone is enough to satisfy the fCC exercise. The test cases included either strings that were all the same character, which can easily be tested for first, and then either one or two pairs of letters, with strings of small length. My new algorithm could pass the tests, however it wasn't a generic solution for the actual exercise, and would not work for all possible inputs. If the problem statement was that only pairs of duplicate letters were possible, then this would be the optimal stopping point.</p>

<p>The possible inputs aren't specified, so we must assume they are free-form, meaning we can get three of the same letter. What happens then?</p>



<pre><code>permAlone(&#39;aaa&#39;)        =       0
permAlone(&#39;aaab&#39;)       =       0
permAlone(&#39;aaabc&#39;)      =      12
permAlone(&#39;aaabcd&#39;)     =     144
permAlone(&#39;aaabcde&#39;)    =    1440
permAlone(&#39;aaabcdef&#39;)   =   14400
permAlone(&#39;aaabcdefg&#39;)  =  151200
permAlone(&#39;aaabcdefgh&#39;) = 1693440
</code></pre>



<p>This sequence appears in OEIS in <a href="https://web.archive.org/web/20170702092920/https://oeis.org/A182062/table">entry A182062</a> on the fourth line of the "square array" section, in a count of permutations of how to queue men and women in line so that no two men are adjacent... an odd thing to be concerned about, for certain. The formula isn't iterative, as the pairs formula is, but just uses straight factorials and binomial coefficients.</p>

<h3>Submitting to the OEIS</h3>

<p>One of my test sequences was combining three of a kind with a pair:</p>



<pre><code>permAlone(&#39;aaabb&#39;)        =        12
permAlone(&#39;aaabbc&#39;)       =       120
permAlone(&#39;aaabbcd&#39;)      =      1152
permAlone(&#39;aaabbcde&#39;)     =     11520
permAlone(&#39;aaabbcdef&#39;)    =    122400
permAlone(&#39;aaabbcdefg&#39;)   =   1391040
permAlone(&#39;aaabbcdefgh&#39;)  =  16934400
permAlone(&#39;aaabbcdefghi&#39;) = 220631040
</code></pre>



<p>These numbers appeared nowhere on the Internet that I could find, which inidicated to me that there was not a known general formula for this type of problem. Given that the sequence directly relates to a combinatorics problem, it was a good candidate for a new OEIS entry, so I took a sidebar to register an account with them, and set about searching for a formula for this specific sequence.</p>

<p>After some experimentation, I found that the numbers all divided evenly by the factorial of the string's length (n) minus 3, giving this sequence:</p>



<pre><code>&#91;6, 20, 48, 96, 170, 276, 420, 608, 846, 1140, 1496, 1920, 2418&#93;
</code></pre>



<p>Searching for that sequence on OEIS didn't return an existing entry, but did run some math on the sequence and displayed the message "Your sequence appears to be: +1x<sup>3</sup> + 1x<sup>2</sup> + 4x". Since the first value is from n=5, "x" is n-4. Using that, we can ask Wolfram Alpha to verify our results <a href="https://web.archive.org/web/20170702092920/http://www.wolframalpha.com/input/?i=Table%5B%28n-3%29%21+%2A+%28%28n-4%29%5E3+%2B+%28n-4%29%5E2+%2B+4%28n-4%29%29%2C+%7Bn%2C+5%2C+12%7D%5D">with a table</a>:</p>

<p><img src="https://web.archive.org/web/20170702092920im_/https://c2.staticflickr.com/2/1594/24044066025%5Fbb2e3fc661%5Fz.jpg" alt=""/></p>

<p>After verifying the equation, I generated the sequence up to 17 values (n from 5 to 21), and submitted it to OEIS <a href="https://web.archive.org/web/20170702092920/https://oeis.org/draft/A266393">as a draft</a>, describing the sequence as "Permutations of n letters where there are exactly 3 A's and 2 B's, where no A's are adjacent and no B's are adjacent". Hopefully it will be accepted as a permanent entry, pushing someone more stubborn than me in the future closer to finding a general equation to handle all input types for this problem.</p>

<h3>Better brute-forcing</h3>

<p>Since I could find no single formula for all possible inputs, my original solution of brute force iterating was the best option. My method of generating all the permutations was correct, but bloated. A better method is mentioned on the <a href="https://web.archive.org/web/20170702092920/https://github.com/FreeCodeCamp/FreeCodeCamp/wiki/Bonfire-No-Repeats-Please">fCC wiki page</a> for this problem: Heap's Algorithm.</p>

<p>B. R. Heap, who has thusfar resisted my attempts to identify him or her, published <a href="https://web.archive.org/web/20170702092920/https://scholar.google.com/scholar?q=b.r.+heap">several papers</a> on ferromagnetism, group theory, and the fortran language in the 1960s. In a 1963 article in The Computer Journal titled <a href="https://web.archive.org/web/20170702092920/http://comjnl.oxfordjournals.org/content/6/3/293.full.pdf">Permutations by interchanges</a>, Heap introduced a permutation generator that uses single item swaps in a particular order.</p>

<p>The algorithm is very efficient, is cited in <a href="https://web.archive.org/web/20170702092920/https://scholar.google.com/scholar?cites=13253158272816423306">45 other papers</a>, and made it's way into Knuth's section of combinatorial algorithms:</p>

<p><img src="https://web.archive.org/web/20170702092920im_/https://c2.staticflickr.com/2/1468/23676236999%5Ffc28179302%5Fz.jpg" alt=""/></p>

<p>Knuth's notation is describing a nested loop, swapping a list's first item and current outer position if the outer position is even (0 indexed), or the outer position and inner position if the outer position is odd. Heap's own paper describes using a pre-generated list of swaps, and then pitches the odd/even algorithm at the end almost as an afterthought:</p>

<p><img src="https://web.archive.org/web/20170702092920im_/https://c2.staticflickr.com/2/1669/23748399500%5F8804367e6a%5Fc.jpg" alt=""/></p>

<p>Here is an animation of Heap's algorithm running on a 4 character string:</p>

<p><img src="https://web.archive.org/web/20170702092920im_/https://c2.staticflickr.com/6/5733/23749076690%5F49eed0933f%5Fo.gif" alt=""/></p>

<p>All the implementations I found wrote this out as a recursive function, some using a global array of position indices to increment and set back to 0. My implementation is a single, non-recursive loop, using modular arithmetic to determine what items get swapped. It uses a callback function reference to be run after every swap, which in the case of the fCC exercise is comparing adjacent characters, and incrementing a counter if no duplicates are found:</p>



<pre><code>function iterate(arr, callback) &#123;
    var fac = &#91;1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880, 3628800, 39916800, 479001600, 6227020800, 87178291200, 1307674368000, 20922789888000, 355687428096000, 6402373705728000&#93;;
    function swap(a, b) &#123;
        var tmp = arr&#91;a&#93;;
        arr&#91;a&#93; = arr&#91;b&#93;;
        arr&#91;b&#93; = tmp;
    &#125;

    callback(arr);
    for (var iter = 1, last = fac&#91;arr.length&#93;; iter &lt; last; iter++) &#123;
        if (iter % 2) swap(0, 1);
        else if (iter % 6) swap(0, 2);
        else &#123;
            var cycle = arr.length - 1;
            while (iter % fac&#91;cycle&#93; &gt; 0) cycle--;
            var left = cycle % 2 == 0 ? 0 : (iter / fac&#91;cycle&#93; - 1) % (cycle + 1);
            swap(left, cycle);
        &#125;
        callback(arr);
    &#125;
&#125;

function permAlone(str) &#123;
    var arr = str.split(&#39;&#39;), out = 0;
    function test() &#123;
        if (arr.every((elem, ndx) =&gt; elem != arr&#91;ndx + 1&#93;)) out++;
    &#125;
    iterate(arr, test);
    return out;
&#125;
</code></pre>



<p>Predictably, this runs faster on longer strings due to not using recursion (preventing a large call stack), or a new array for each iteration, both of which my rough draft solution used.</p>

<p>So, there you have it, a seemingly simple algorithm coding challenge, that has some subtlety, and hopefully will have a purely formulaic solution in the future.</p>

<p>Enjoy!</p>


			</div>
			<hr/>
		

	</div>
	<script src="/web/20170702092920js_/http://curtisautery.appspot.com/static/jquery/jquery-2.0.3.min.js"></script>
	<script src="/web/20170702092920js_/http://curtisautery.appspot.com/static/bootstrap/js/bootstrap.min.js"></script>
</body>
</html>
<!--
     FILE ARCHIVED ON 09:29:20 Jul 02, 2017 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 17:33:26 Oct 26, 2020.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  load_resource: 135.6
  captures_list: 293.556
  exclusion.robots: 0.345
  RedisCDXSource: 4.596
  exclusion.robots.policy: 0.329
  PetaboxLoader3.resolve: 55.578
  esindex: 0.017
  LoadShardBlock: 258.595 (3)
  CDXLines.iter: 25.075 (3)
  PetaboxLoader3.datanode: 270.6 (4)
-->